{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/regenerator\";\nimport _classCallCheck from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _objectSpread from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"/Users/jonathan/ecv-demo-view/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/jonathan/ecv-demo-view/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport Table from \"./Table.jsx\";\nimport PropTypes from 'prop-types';\nimport { createMuiTheme, MuiThemeProvider, withStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport AccountCircle from '@material-ui/icons/AccountCircle';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\nimport Drawer from '@material-ui/core/Drawer';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport Grid from '@material-ui/core/Grid';\nimport { PacmanLoader } from 'react-spinners'; // import Paper from '@material-ui/core/Paper';\n\nimport { drawerListItems, otherListItems } from './drawerList';\nimport Webcam from \"react-webcam\";\nimport Amplify, { API, Storage } from 'aws-amplify';\nimport aws_exports from './aws-exports';\nimport { withAuthenticator } from 'aws-amplify-react';\nAmplify.configure(aws_exports);\nvar input_pic_name;\nvar time;\nvar timestamp;\n\nfunction detectFaces(_x) {\n  return _detectFaces.apply(this, arguments);\n}\n\nfunction _detectFaces() {\n  _detectFaces = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(bytes) {\n    var apiName, path, headers, body, init;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            apiName = \"api6832f3b1\";\n            path = \"/items\";\n            time = Date.now();\n            timestamp = Math.floor(time / 1000);\n            input_pic_name = timestamp.toString();\n            _context2.next = 7;\n            return Storage.put(input_pic_name + '.jpg', bytes).then(function (result) {\n              return console.log(result);\n            }).catch(function (err) {\n              return console.log(err);\n            });\n\n          case 7:\n            headers = {\n              \"Content-Type\": \"application/json\"\n            };\n            body = {\n              \"image\": input_pic_name + '.jpg'\n            };\n            console.log(body);\n            init = {\n              body: body,\n              headers: headers\n            };\n            console.log(init);\n            _context2.next = 14;\n            return API.post(apiName, path, init);\n\n          case 14:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, this);\n  }));\n  return _detectFaces.apply(this, arguments);\n}\n\nvar new_font_theme = createMuiTheme({\n  typography: {\n    useNextVariants: true\n  }\n}); // stylesheet of every component\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      flexGrow: 1,\n      // height: 440,\n      zIndex: 1,\n      overflow: 'hidden',\n      position: 'relative',\n      display: 'flex',\n      useNextVariants: true\n    },\n    grow: {\n      flexGrow: 1\n    },\n    menuButton: {\n      marginLeft: -12,\n      marginRight: 20\n    },\n    appBar: {\n      backgroundColor: '#000000',\n      zIndex: theme.zIndex.drawer + 1\n    },\n    drawerPaper: {\n      position: 'relative',\n      width: 240\n    },\n    list: {\n      width: 250\n    },\n    fullList: {\n      width: 'auto'\n    },\n    content: {\n      flexGrow: 1,\n      // backgroundColor: theme.palette.background.default,\n      padding: theme.spacing.unit * 3,\n      minWidth: 0 // So the Typography noWrap works\n\n    },\n    toolbar: _objectSpread({\n      display: 'flex',\n      alignItems: 'center',\n      // justifyContent: 'flex-end',\n      padding: '0 8px',\n      marginLeft: 'auto',\n      marginRight: 'auto'\n    }, theme.mixins.toolbar),\n    videoFrame: {\n      // margin: 'auto',\n      display: 'block',\n      maxWidth: '100%',\n      maxHeight: '100%'\n    },\n    button: {\n      margin: theme.spacing.unit * 4,\n      fontFamily: 'Arial'\n    }\n  };\n};\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this));\n\n    _this.toggleDrawer = function (open) {\n      return function () {\n        _this.setState({\n          drawer_open: open\n        });\n      };\n    };\n\n    _this.handleChange = function (event) {\n      _this.setState({\n        auth: event.target.checked\n      });\n    };\n\n    _this.handleMenu = function (event) {\n      _this.setState({\n        anchorEl: event.currentTarget\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        anchorEl: null\n      });\n    };\n\n    _this.setRef = function (webcam) {\n      _this.webcam = webcam;\n    };\n\n    _this.capture =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var imageSrc, imageCanvas, context, img, faceDetections, low_age, high_age, predict_age, gender, emotions, isSmile;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              imageSrc = _this.webcam.getScreenshot();\n              imageCanvas = _this.webcam.getCanvas();\n\n              _this.setState({\n                videoSrc: imageSrc\n              });\n\n              _this.setState({\n                image: imageCanvas\n              });\n\n              console.log(imageSrc);\n              console.log(\"canvas: \" + imageCanvas);\n              context = _this.canvas.getContext(\"2d\");\n              context.drawImage(imageCanvas, 0, 0, 640, 480);\n              img = _this.dataURItoBlob(imageSrc);\n              console.log(img);\n              _context.prev = 10;\n              _context.next = 13;\n              return detectFaces(img);\n\n            case 13:\n              faceDetections = _context.sent;\n              console.log(faceDetections);\n\n              _this.setState({\n                rekognition_callback: faceDetections.body.FaceDetails[0]\n              });\n\n              console.log(faceDetections.body.FaceDetails[0]);\n              low_age = JSON.stringify(faceDetections.body.FaceDetails[0].AgeRange.Low);\n              high_age = JSON.stringify(faceDetections.body.FaceDetails[0].AgeRange.High);\n              predict_age = (parseInt(low_age) + parseInt(high_age)) / 2;\n\n              _this.setState({\n                age: predict_age.toString()\n              });\n\n              console.log(predict_age);\n              gender = faceDetections.body.FaceDetails[0].Gender.Value;\n\n              _this.setState({\n                gender: gender\n              });\n\n              console.log(gender);\n              emotions = faceDetections.body.FaceDetails[0].Emotions[0].Type;\n\n              _this.setState({\n                emotion: emotions\n              });\n\n              console.log(emotions);\n              isSmile = faceDetections.body.FaceDetails[0].Smile.Value;\n\n              if (isSmile) {\n                _this.setState({\n                  isSmile: \"yes\"\n                });\n              } else {\n                _this.setState({\n                  isSmile: \"no\"\n                });\n              }\n\n              console.log(\"isSmile: \" + isSmile);\n              _context.next = 36;\n              break;\n\n            case 33:\n              _context.prev = 33;\n              _context.t0 = _context[\"catch\"](10);\n              console.log(\"error\", _context.t0); // alert(\"error occur\");\n\n            case 36:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[10, 33]]);\n    }));\n\n    _this.dataURItoBlob = function (dataURI) {\n      // convert base64/URLEncoded data component to raw binary data held in a string\n      var byteString;\n      if (dataURI.split(',')[0].indexOf('base64') >= 0) byteString = atob(dataURI.split(',')[1]);else byteString = unescape(dataURI.split(',')[1]); // separate out the mime component\n\n      var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]; // write the bytes of the string to a typed array\n\n      var ia = new Uint8Array(byteString.length);\n\n      for (var i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n      }\n\n      return new Blob([ia], {\n        type: mimeString\n      });\n    };\n\n    _this.state = {\n      auth: true,\n      anchorEl: null,\n      drawer_open: false,\n      videoSrc: null,\n      image: null,\n      rekognition_callback: null,\n      age: null,\n      gender: null,\n      emotion: null,\n      isSmile: null\n    };\n    return _this;\n  } // ---function of drawer event control---\n\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {}\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {}\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var classes = this.props.classes;\n      var _this$state = this.state,\n          auth = _this$state.auth,\n          anchorEl = _this$state.anchorEl;\n      var open = Boolean(anchorEl);\n      var drawerList = React.createElement(MuiThemeProvider, {\n        theme: new_font_theme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.list,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, React.createElement(List, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, drawerListItems), React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }), React.createElement(List, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, otherListItems)));\n      return React.createElement(\"div\", {\n        className: classes.root,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }, React.createElement(AppBar, {\n        position: \"absolute\",\n        className: classes.appBar,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        className: classes.menuButton,\n        color: \"inherit\",\n        \"aria-label\": \"Menu\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, React.createElement(MenuIcon, {\n        onClick: this.toggleDrawer(true),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      })), React.createElement(Typography, {\n        variant: \"h6\",\n        color: \"inherit\",\n        className: classes.grow,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }, \"eCloudvalley demo\"), auth && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        \"aria-owns\": open ? 'menu-appbar' : null,\n        \"aria-haspopup\": \"true\",\n        onClick: this.handleMenu,\n        color: \"inherit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      }, React.createElement(AccountCircle, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      })), React.createElement(Menu, {\n        id: \"menu-appbar\",\n        anchorEl: anchorEl,\n        anchorOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        transformOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        open: open,\n        onClose: this.handleClose,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290\n        },\n        __self: this\n      }, React.createElement(MenuItem, {\n        onClick: this.handleClose,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, \"Profile\"), React.createElement(MenuItem, {\n        onClick: this.handleClose,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, \"My account\"))))), React.createElement(Drawer, {\n        open: this.state.drawer_open,\n        onClose: this.toggleDrawer(false),\n        classes: {\n          paper: classes.drawerPaper\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.toolbar,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: require('./ecloud.svg'),\n        alt: \"icon\",\n        height: \"57\",\n        width: \"75\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        tabIndex: 0,\n        role: \"button\",\n        onClick: this.toggleDrawer(false),\n        onKeyDown: this.toggleDrawer(false),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, drawerList)), React.createElement(\"main\", {\n        className: classes.content,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.toolbar,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        container: true,\n        spacing: 24,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 6,\n        className: classes.videoFrame,\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        noWrap: true,\n        variant: \"h4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }, \"Take a photo here\"), React.createElement(Webcam, {\n        screenshotFormat: \"image/jpeg\",\n        ref: this.setRef,\n        audio: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }), React.createElement(\"center\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"secondary\",\n        className: classes.button,\n        size: \"large\",\n        onClick: this.capture,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, \"Click it\"))), React.createElement(Grid, {\n        item: true,\n        xs: 6,\n        className: classes.videoFrame,\n        margin: \"auto\",\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        noWrap: true,\n        variant: \"h4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 355\n        },\n        __self: this\n      }, \"Detect your beautiful face\"), React.createElement(\"canvas\", {\n        ref: function ref(canvas) {\n          return _this2.canvas = canvas;\n        },\n        width: \"640\",\n        height: \"480\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 358\n        },\n        __self: this\n      }), React.createElement(Typography, {\n        variant: \"h5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      }, \"Results\"), React.createElement(PacmanLoader, {\n        color: '#36D7B7',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }), React.createElement(Table, {\n        tableHeaderColor: \"primary\",\n        tableHead: ['Age', 'Gender', 'Emotions', 'Do you smile ?'],\n        tableData: [[this.state.age, this.state.gender, this.state.emotion, this.state.isSmile]],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nApp.defaultProps = {\n  tableHeaderColor: 'gray'\n};\nApp.propTypes = {\n  classes: PropTypes.object.isRequired,\n  tableHeaderColor: PropTypes.oneOf(['warning', 'primary', 'danger', 'success', 'info', 'rose', 'gray']),\n  tableHead: PropTypes.arrayOf(PropTypes.string),\n  tableData: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string))\n};\nexport default withAuthenticator(withStyles(styles)(App, true)); // export default withStyles(styles)(App);","map":{"version":3,"sources":["/Users/jonathan/ecv-demo-view/src/App.js"],"names":["React","Table","PropTypes","createMuiTheme","MuiThemeProvider","withStyles","AppBar","Toolbar","Typography","IconButton","MenuIcon","AccountCircle","MenuItem","Menu","Drawer","Button","List","Divider","Grid","PacmanLoader","drawerListItems","otherListItems","Webcam","Amplify","API","Storage","aws_exports","withAuthenticator","configure","input_pic_name","time","timestamp","detectFaces","bytes","apiName","path","Date","now","Math","floor","toString","put","then","result","console","log","catch","err","headers","body","init","post","new_font_theme","typography","useNextVariants","styles","theme","root","flexGrow","zIndex","overflow","position","display","grow","menuButton","marginLeft","marginRight","appBar","backgroundColor","drawer","drawerPaper","width","list","fullList","content","padding","spacing","unit","minWidth","toolbar","alignItems","mixins","videoFrame","maxWidth","maxHeight","button","margin","fontFamily","App","toggleDrawer","open","setState","drawer_open","handleChange","event","auth","target","checked","handleMenu","anchorEl","currentTarget","handleClose","setRef","webcam","capture","imageSrc","getScreenshot","imageCanvas","getCanvas","videoSrc","image","context","canvas","getContext","drawImage","img","dataURItoBlob","faceDetections","rekognition_callback","FaceDetails","low_age","JSON","stringify","AgeRange","Low","high_age","High","predict_age","parseInt","age","gender","Gender","Value","emotions","Emotions","Type","emotion","isSmile","Smile","dataURI","byteString","split","indexOf","atob","unescape","mimeString","ia","Uint8Array","length","i","charCodeAt","Blob","type","state","classes","props","Boolean","drawerList","vertical","horizontal","paper","require","Component","defaultProps","tableHeaderColor","propTypes","object","isRequired","oneOf","tableHead","arrayOf","string","tableData"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport Table from \"./Table.jsx\";\nimport PropTypes from 'prop-types';\nimport { createMuiTheme, MuiThemeProvider, withStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport AccountCircle from '@material-ui/icons/AccountCircle';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\nimport Drawer from '@material-ui/core/Drawer';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport Grid from '@material-ui/core/Grid';\nimport { PacmanLoader } from 'react-spinners';\n// import Paper from '@material-ui/core/Paper';\nimport { drawerListItems, otherListItems } from './drawerList';\nimport Webcam from \"react-webcam\";\n\nimport Amplify, { API, Storage } from 'aws-amplify';\nimport aws_exports from './aws-exports';\nimport { withAuthenticator } from 'aws-amplify-react';\n\nAmplify.configure(aws_exports);\nvar input_pic_name;\nvar time;\nvar timestamp;\n\nasync function detectFaces(bytes){\n  const apiName = \"api6832f3b1\";\n  const path = \"/items\"\n  time = Date.now();\n  timestamp = Math.floor(time / 1000);\n  input_pic_name = timestamp.toString();\n\n  await Storage.put(input_pic_name + '.jpg', bytes)\n  .then (result => console.log(result))\n  .catch(err => console.log(err));\n\n  const headers = {\n    \"Content-Type\": \"application/json\",\n  };\n  const body = {\n    \"image\": input_pic_name + '.jpg'\n  };\n  console.log(body);\n\n  const init = {\n   body: body,\n   headers: headers\n };\n console.log(init);\n\n return await API.post(apiName, path, init);\n}\n\nconst new_font_theme = createMuiTheme({\n  typography: {\n    useNextVariants: true,\n  },\n});\n// stylesheet of every component\nconst styles = theme => ({\n  root: {\n    flexGrow: 1,\n    // height: 440,\n    zIndex: 1,\n    overflow: 'hidden',\n    position: 'relative',\n    display: 'flex',\n    useNextVariants: true,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  menuButton: {\n    marginLeft: -12,\n    marginRight: 20,\n  },\n  appBar: {\n    backgroundColor: '#000000',\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  drawerPaper: {\n    position: 'relative',\n    width: 240,\n  },\n  list: {\n    width: 250,\n  },\n  fullList: {\n    width: 'auto',\n  },\n  content: {\n    flexGrow: 1,\n    // backgroundColor: theme.palette.background.default,\n    padding: theme.spacing.unit * 3,\n    minWidth: 0, // So the Typography noWrap works\n  },\n  toolbar: {\n    display: 'flex',\n    alignItems: 'center',\n    // justifyContent: 'flex-end',\n    padding: '0 8px',\n    marginLeft: 'auto',\n    marginRight: 'auto',\n    ...theme.mixins.toolbar,\n  },\n  videoFrame: {\n    // margin: 'auto',\n    display: 'block',\n    maxWidth: '100%',\n    maxHeight: '100%',\n  },\n  button: {\n   margin: theme.spacing.unit * 4,\n   fontFamily: 'Arial'\n },\n});\n\nclass App extends React.Component {\n  constructor(){\n    super();\n    this.state = {\n      auth: true,\n      anchorEl: null,\n      drawer_open: false,\n      videoSrc: null,\n      image: null,\n      rekognition_callback: null,\n      age: null,\n      gender: null,\n      emotion: null,\n      isSmile: null,\n    };\n  }\n\n\n// ---function of drawer event control---\n\n  toggleDrawer = (open) => () => {\n    this.setState({\n      drawer_open: open,\n    });\n  };\n\n  handleChange = event => {\n    this.setState({ auth: event.target.checked });\n  };\n\n  handleMenu = event => {\n    this.setState({ anchorEl: event.currentTarget });\n  };\n\n  handleClose = () => {\n    this.setState({ anchorEl: null });\n  };\n\n// ---function of webcam and canvas---\n\n  setRef = webcam => {\n    this.webcam = webcam;\n  };\n\n  capture = async () => {\n    const imageSrc = this.webcam.getScreenshot();\n    const imageCanvas = this.webcam.getCanvas();\n    this.setState({videoSrc: imageSrc});\n    this.setState({image: imageCanvas});\n    console.log(imageSrc);\n    console.log(\"canvas: \" + imageCanvas);\n    const context = this.canvas.getContext(\"2d\");\n    context.drawImage(imageCanvas, 0, 0, 640, 480);\n    const img = this.dataURItoBlob(imageSrc)\n    console.log(img);\n\n    try {\n      const faceDetections = await detectFaces(img);\n      console.log(faceDetections);\n      this.setState({\n        rekognition_callback: faceDetections.body.FaceDetails[0]\n      });\n      console.log(faceDetections.body.FaceDetails[0]);\n      var low_age = JSON.stringify(faceDetections.body.FaceDetails[0].AgeRange.Low);\n      var high_age = JSON.stringify(faceDetections.body.FaceDetails[0].AgeRange.High);\n      var predict_age = (parseInt(low_age) + parseInt(high_age)) / 2;\n      this.setState({\n        age: predict_age.toString()\n      })\n      console.log(predict_age);\n      var gender = faceDetections.body.FaceDetails[0].Gender.Value;\n      this.setState({\n        gender: gender\n      })\n      console.log(gender);\n      var emotions = faceDetections.body.FaceDetails[0].Emotions[0].Type;\n      this.setState({\n        emotion: emotions\n      })\n      console.log(emotions);\n      var isSmile = faceDetections.body.FaceDetails[0].Smile.Value;\n      if (isSmile){\n        this.setState({\n          isSmile: \"yes\"\n        })\n      } else{\n        this.setState({\n          isSmile: \"no\"\n        })\n      }\n      console.log(\"isSmile: \" + isSmile);\n\n    } catch (err) {\n      console.log(\"error\", err);\n      // alert(\"error occur\");\n    }\n\n  };\n\n    dataURItoBlob = (dataURI) => {\n    // convert base64/URLEncoded data component to raw binary data held in a string\n    var byteString;\n    if (dataURI.split(',')[0].indexOf('base64') >= 0)\n      byteString = atob(dataURI.split(',')[1]);\n    else\n      byteString = unescape(dataURI.split(',')[1]);\n    // separate out the mime component\n    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n    // write the bytes of the string to a typed array\n    var ia = new Uint8Array(byteString.length);\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([ia], {\n      type: mimeString\n    });\n  }\n\n  componentDidMount() {\n\n  }\n\n\n  componentDidUpdate() {\n\n  }\n\n\n  render() {\n    const { classes } = this.props;\n    const { auth, anchorEl } = this.state;\n    const open = Boolean(anchorEl);\n\n    const drawerList = (\n      <MuiThemeProvider theme={new_font_theme}>\n      <div className={classes.list}>\n        <List>{drawerListItems}</List>\n        <Divider />\n        <List>{otherListItems}</List>\n      </div>\n    </MuiThemeProvider>\n    );\n\n\n\n    return (\n      <div className={classes.root}>\n        <AppBar position=\"absolute\" className={classes.appBar}>\n          <Toolbar>\n            <IconButton className={classes.menuButton} color=\"inherit\" aria-label=\"Menu\">\n              <MenuIcon onClick={this.toggleDrawer(true)}/>\n            </IconButton>\n            <Typography variant=\"h6\" color=\"inherit\" className={classes.grow}>\n              eCloudvalley demo\n            </Typography>\n            {auth && (\n              <div>\n                <IconButton\n                  aria-owns={open ? 'menu-appbar' : null}\n                  aria-haspopup=\"true\"\n                  onClick={this.handleMenu}\n                  color=\"inherit\"\n                >\n                  <AccountCircle />\n                </IconButton>\n                <Menu\n                  id=\"menu-appbar\"\n                  anchorEl={anchorEl}\n                  anchorOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right',\n                  }}\n                  transformOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right',\n                  }}\n                  open={open}\n                  onClose={this.handleClose}\n                >\n                  <MenuItem onClick={this.handleClose}>Profile</MenuItem>\n                  <MenuItem onClick={this.handleClose}>My account</MenuItem>\n                </Menu>\n              </div>\n            )}\n          </Toolbar>\n        </AppBar>\n\n        <Drawer open={this.state.drawer_open} onClose={this.toggleDrawer(false)}\n          classes={{paper: classes.drawerPaper}}>\n          <div className={classes.toolbar}>\n            <img src={require('./ecloud.svg')} alt=\"icon\" height=\"57\" width=\"75\"/>\n          </div>\n          <div\n            tabIndex={0}\n            role=\"button\"\n            onClick={this.toggleDrawer(false)}\n            onKeyDown={this.toggleDrawer(false)}\n          >\n            {drawerList}\n          </div>\n        </Drawer>\n\n        <main className={classes.content}>\n          <div className={classes.toolbar} />\n\n          <Grid container spacing={24}>\n\n            <Grid item xs={6} className={classes.videoFrame} align=\"center\">\n              <Typography noWrap variant=\"h4\">\n                Take a photo here\n              </Typography>\n\n              <Webcam\n                screenshotFormat=\"image/jpeg\"\n                ref={this.setRef}\n                audio={false}/>\n\n              <center>\n              <Button\n                variant=\"contained\"\n                color=\"secondary\"\n                className={classes.button}\n                size=\"large\"\n                onClick={this.capture}>\n                Click it\n              </Button>\n              </center>\n\n            </Grid>\n            <Grid item xs={6} className={classes.videoFrame} margin=\"auto\" align=\"center\">\n              <Typography noWrap variant=\"h4\">\n                Detect your beautiful face\n              </Typography>\n              <canvas\n                ref={canvas => this.canvas = canvas}\n                width=\"640\"\n                height=\"480\"\n              />\n                <Typography variant=\"h5\">Results</Typography>\n                <PacmanLoader color={'#36D7B7'}/>\n                <Table\n                  tableHeaderColor=\"primary\"\n                  tableHead={['Age','Gender','Emotions','Do you smile ?']}\n                  tableData={[\n                      [ this.state.age , this.state.gender, this.state.emotion, this.state.isSmile] ,\n                  ]}\n                />\n\n\n            </Grid>\n\n        </Grid>\n\n        </main>\n      </div>\n    );\n  }\n}\nApp.defaultProps = {\n    tableHeaderColor: 'gray'\n}\nApp.propTypes = {\n  classes: PropTypes.object.isRequired,\n  tableHeaderColor: PropTypes.oneOf(['warning','primary','danger','success','info','rose','gray']),\n  tableHead: PropTypes.arrayOf(PropTypes.string),\n  tableData: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string))\n};\nexport default withAuthenticator(withStyles(styles)(App, true));\n// export default withStyles(styles)(App);\n"]},"metadata":{},"sourceType":"module"}